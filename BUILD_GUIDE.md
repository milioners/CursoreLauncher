# Руководство по сборке Cursor Launcher

## Обзор

В проекте доступны два скрипта для сборки релизов:
- `build_release.ps1` - PowerShell скрипт (рекомендуется)
- `build_release.bat` - Batch скрипт (для совместимости)

## Требования

### Обязательные зависимости
- **Python 3.7+** - основной язык разработки
- **PyInstaller** - для создания исполняемых файлов
  ```bash
  pip install pyinstaller
  ```

### Опциональные зависимости
- **Git** - для работы с версиями и тегами
- **NSIS** - для создания установщиков (только для PowerShell скрипта)

## Использование PowerShell скрипта

### Базовое использование
```powershell
.\build_release.ps1
```

### Параметры
```powershell
.\build_release.ps1 -Version "1.3.0"                    # Указать версию
.\build_release.ps1 -SkipTests                          # Пропустить тесты
.\build_release.ps1 -SkipGit                            # Пропустить Git операции
.\build_release.ps1 -CreateInstaller                    # Создать установщик
.\build_release.ps1 -Help                               # Показать справку
```

### Примеры
```powershell
# Сборка с автоматическим определением версии
.\build_release.ps1

# Сборка конкретной версии с установщиком
.\build_release.ps1 -Version "1.3.0" -CreateInstaller

# Быстрая сборка без тестов
.\build_release.ps1 -SkipTests -SkipGit
```

## Использование Batch скрипта

### Базовое использование
```cmd
build_release.bat
```

### Параметры
```cmd
build_release.bat --version 1.3.0                       # Указать версию
build_release.bat --skip-tests                          # Пропустить тесты
build_release.bat --skip-git                            # Пропустить Git операции
build_release.bat --create-installer                    # Создать установщик
build_release.bat --help                                # Показать справку
```

### Примеры
```cmd
# Сборка с автоматическим определением версии
build_release.bat

# Сборка конкретной версии
build_release.bat --version 1.3.0

# Быстрая сборка без тестов
build_release.bat --skip-tests --skip-git
```

## Что делает скрипт

### 1. Проверка зависимостей
- Проверяет наличие Python, PyInstaller и Git
- Выводит статус каждой зависимости

### 2. Проверка качества кода
- Компилирует основной файл `launcher.py`
- Проверяет импорты
- Компилирует все плагины в папке `plugins/`

### 3. Очистка
- Удаляет предыдущие сборки (`dist/`, `build/`, `launcher.spec`)

### 4. Сборка
- Создает исполняемый файл с помощью PyInstaller
- Включает плагины и конфигурационные файлы
- Измеряет время сборки

### 5. Подготовка релиза
- Создает папку `release/`
- Копирует все необходимые файлы
- Создает архив для распространения
- Генерирует релизные заметки

### 6. Git операции (опционально)
- Создает коммит с изменениями
- Создает тег версии
- Отправляет изменения на GitHub

## Создаваемые файлы

После успешной сборки в папке `release/` будут созданы:

```
release/
├── CursorLauncher.exe              # Основной исполняемый файл
├── plugins/                        # Папка с плагинами
├── *.json                          # Конфигурационные файлы
├── README.md                       # Документация
├── USER_GUIDE.md                   # Руководство пользователя
├── CHANGELOG.md                    # История изменений
├── RELEASE_NOTES.md                # Заметки о релизе
└── CursorLauncher-v1.3.0.zip       # Архив для распространения
```

## Создание установщика

Для создания установщика требуется NSIS (Nullsoft Scriptable Install System):

1. Скачайте и установите NSIS с [официального сайта](https://nsis.sourceforge.io/)
2. Добавьте NSIS в PATH или установите в стандартную папку
3. Используйте параметр `-CreateInstaller` (PowerShell) или `--create-installer` (Batch)

Установщик создаст:
- Ярлыки в меню "Пуск" и на рабочем столе
- Запись в реестре для удаления
- Профессиональный интерфейс установки

## Автоматическое определение версии

Если версия не указана, скрипт попытается:
1. Получить последний Git тег
2. Использовать версию по умолчанию (1.0.0)

## Статистика сборки

В конце процесса выводится:
- Версия сборки
- Время сборки
- Размер исполняемого файла
- Размер архива

## Устранение неполадок

### Ошибка "Python не найден"
```bash
# Установите Python с python.org или используйте менеджер пакетов
# Убедитесь, что Python добавлен в PATH
```

### Ошибка "PyInstaller не найден"
```bash
pip install pyinstaller
```

### Ошибка синтаксиса
- Проверьте код на наличие синтаксических ошибок
- Убедитесь, что все импорты корректны
- Проверьте плагины на ошибки

### Ошибка сборки
- Проверьте, что все зависимости установлены
- Убедитесь, что файлы не заблокированы другими процессами
- Проверьте права доступа к папкам

### Git ошибки
- Убедитесь, что репозиторий инициализирован
- Проверьте настройки Git (имя пользователя, email)
- Убедитесь, что есть доступ к удаленному репозиторию

## Рекомендации

1. **Используйте PowerShell скрипт** - он более функциональный и информативный
2. **Всегда проверяйте код** перед сборкой релиза
3. **Тестируйте сборку** на чистой системе
4. **Ведите CHANGELOG.md** для отслеживания изменений
5. **Создавайте установщики** для удобства пользователей

## Интеграция с CI/CD

Скрипты можно интегрировать в системы непрерывной интеграции:

```yaml
# GitHub Actions пример
- name: Build Release
  run: |
    .\build_release.ps1 -Version ${{ github.ref_name }} -SkipGit
```

```yaml
# GitLab CI пример
build_release:
  script:
    - ./build_release.ps1 -Version $CI_COMMIT_TAG -SkipGit
``` 